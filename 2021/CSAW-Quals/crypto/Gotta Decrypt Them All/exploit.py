#!/usr/bin/env python3
from Crypto.Util.number import *
from labmath import *
import base64, codecs
from pwn import *

p = remote('crypto.chal.csaw.io', 5001)

mdict = {
	'.----' : 1,
	'..---' : 2,
	'...--' : 3,
	'....-' : 4,
	'.....' : 5,
	'-....' : 6,
	'--...' : 7,
	'---..' : 8,
	'----.' : 9,
	'-----' : 0,

}

# morse -> int -> b64 -> rsa -> rot13
while True:
	try:
		data = p.recvuntil('>').split(b'\r\n')[3].decode()
		
		morse = data.split('/')
		text = ''
		for w in morse:
			ws = w.split()
			tmp = 0
			for m in ws:
				tmp *= 10
				tmp += mdict[m]
			text += chr(tmp)

		text = base64.b64decode(text).split()		
		e = int(text[-4])
		m = introot(int(text[-1]), r=e)
		m = long_to_bytes(m).decode()
		ans = codecs.encode(m, 'rot_13')
		print(ans)
		p.sendlineafter('> ', ans)

	except:
		p.interactive()
		exit()

# flag{We're_ALrEadY_0N_0uR_waY_7HE_j0UrnEY_57aR75_70day!}
